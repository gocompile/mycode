<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="notice">
	<cacheModel id="user-cache" type="LRU" readOnly="true"
		serialize="false">
		<flushInterval hours="24" />
		<property value="500" name="size" />
	</cacheModel>
	
	<!--映射实体类 -->
	<typeAlias alias="notice" type="com.ulewo.entity.Notice" />
	
	<!--单笔查询-->
	<select id="selectById" resultClass="notice" parameterClass="java.lang.Integer">
		select * from notice where id= #id#
	</select>
	
	<!--多笔查询-->
	<select id="selectAll" resultClass="notice" parameterClass="java.util.Map">
		select * from notice
		<dynamic prepend="where">
			<isNotEmpty prepend="and" property="title">
	         	  <![CDATA[title like #title#]]>
			</isNotEmpty>
		</dynamic>
		order by code desc,createtime desc limit  #offset#,#total#
	</select>
		
	<!--查询总数-->
	<select id="selectCount" resultClass="java.lang.Integer" parameterClass="java.lang.String">
		select count(id) from notice
		<dynamic prepend="where">
			<isNotEmpty prepend="and" property="title">
	         	  <![CDATA[title like #title#]]>
			</isNotEmpty>
		</dynamic>
	</select>
	
	<!--删除-->
	<delete id="delete" parameterClass="java.lang.Integer"> 
       delete from notice where id = #id#
	</delete>
	
	<!--更新-->
	<update id="update"  parameterClass="notice">
		update notice set 
		content = #content#,
		code = #code#,
		thumbnail_url = #thumbnailUrl#
		createtime = #createTime#
		where id = #id#
	</update>
	
	<!--新增-->
	<insert id="add" parameterClass="notice">
		insert into notice (content,code,mesthumbnail_url,createtime)
		values(#content#,#code#,#mesthumbnail_url#,#createtime#)
		<selectKey resultClass="int" keyProperty="id">  
   	 		select max(id) from notice  
  	 	</selectKey>  
	</insert>
</sqlMap>
